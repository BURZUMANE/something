{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nexport function usePolling(interval, cb, abortCb) {\n  _s();\n  const isInitial = useRef(true);\n  const [data, setData] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsLoading(true);\n      const response = await cb();\n      setData(response);\n      setIsLoading(false);\n      isInitial.current = false;\n    };\n    fetchData().then();\n    const intervalId = setInterval(fetchData, interval);\n    return () => {\n      console.log(isInitial.current);\n      clearInterval(intervalId);\n      abortCb().abort();\n    };\n  }, [abortCb, cb, interval]);\n  return {\n    data,\n    isLoading\n  };\n}\n_s(usePolling, \"NYF0KR/HpExbh2zHGN+mngZaBVM=\");","map":{"version":3,"names":["useEffect","useRef","useState","usePolling","interval","cb","abortCb","isInitial","data","setData","isLoading","setIsLoading","fetchData","response","current","then","intervalId","setInterval","console","log","clearInterval","abort"],"sources":["/Users/puz/something/src/hooks/usePolling.ts"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\n\nexport function usePolling<T>(interval: number, cb: Function, abortCb: () => AbortController) {\n  const isInitial = useRef(true)\n  const [data, setData] = useState<T | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsLoading(true);\n      const response: T = await cb()\n      setData(response);\n\n      setIsLoading(false);\n      isInitial.current = false;\n    };\n\n    fetchData().then();\n\n    const intervalId = setInterval(fetchData, interval);\n\n    return () => {\n      console.log(isInitial.current);\n      clearInterval(intervalId);\n      abortCb().abort();\n    };\n  }, [abortCb, cb, interval]);\n\n  return {data, isLoading};\n}\n"],"mappings":";AAAA,SAAQA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAO,OAAO;AAEjD,OAAO,SAASC,UAAU,CAAIC,QAAgB,EAAEC,EAAY,EAAEC,OAA8B,EAAE;EAAA;EAC5F,MAAMC,SAAS,GAAGN,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM,CAACO,IAAI,EAAEC,OAAO,CAAC,GAAGP,QAAQ,CAAW,IAAI,CAAC;EAChD,MAAM,CAACQ,SAAS,EAAEC,YAAY,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAEjDF,SAAS,CAAC,MAAM;IACd,MAAMY,SAAS,GAAG,YAAY;MAC5BD,YAAY,CAAC,IAAI,CAAC;MAClB,MAAME,QAAW,GAAG,MAAMR,EAAE,EAAE;MAC9BI,OAAO,CAACI,QAAQ,CAAC;MAEjBF,YAAY,CAAC,KAAK,CAAC;MACnBJ,SAAS,CAACO,OAAO,GAAG,KAAK;IAC3B,CAAC;IAEDF,SAAS,EAAE,CAACG,IAAI,EAAE;IAElB,MAAMC,UAAU,GAAGC,WAAW,CAACL,SAAS,EAAER,QAAQ,CAAC;IAEnD,OAAO,MAAM;MACXc,OAAO,CAACC,GAAG,CAACZ,SAAS,CAACO,OAAO,CAAC;MAC9BM,aAAa,CAACJ,UAAU,CAAC;MACzBV,OAAO,EAAE,CAACe,KAAK,EAAE;IACnB,CAAC;EACH,CAAC,EAAE,CAACf,OAAO,EAAED,EAAE,EAAED,QAAQ,CAAC,CAAC;EAE3B,OAAO;IAACI,IAAI;IAAEE;EAAS,CAAC;AAC1B;AAAC,GA3BeP,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}